# Parallel Debugging

**General caveats**:

* Software to be debugged needs to be compiled with debug symbols
    * For this example, QE should be compiled as `RelWithDebinfo` (source
      install)
* Recent version of [GDB](https://sourceware.org/gdb/) is highly encouraged
  (source install)

The example below is based on debugging QE 7.1, compiled with oneAPI 2021.2 and
Open MPI 4.1.1. Load the software,

```sh
module use /home/anderss/qe/module && module load 7.1
```

**If you are following Option 2 below, start your tmux session now!!**

Now request an interactive SLURM session. The `--x11` flag is included for
generality,

```sh
srun -p small --x11 --pty -n 8 --mem=32G --time=00-01:00:00 /bin/bash
```

Establish some handy environment variables for the job,

```sh
export BASE="/deac/inf/adminGrp/anderss/scratch/natalie/1200K"
export PSEUDO="${BASE}/poscorenhatPBESOL"
export WORKDIR="${BASE}/${SLURM_JOB_ID}"
# export TMPDIR="/scratch/${SLURM_JOB_ID}" # faster, but you lose scratch files
export TMPDIR="${WORKDIR}/scratch"         # slower, but you keep scratch files
export INFILE="${WORKDIR}/md_${SLURM_JOB_ID}.in"
export OUTFILE="${WORKDIR}/md_${SLURM_JOB_ID}.out"
export PW="pw.x"
```

and create the required directories,

```sh
mkdir -p $WORKDIR
mkdir -p $TMPDIR
cd $WORKDIR
```

Lastly, create the input file 

```sh
cat > $INFILE << EOF
&CONTROL
  calculation = "md",
  pseudo_dir  = "$PSEUDO"
  verbosity   = "high",
  outdir      = "$TMPDIR",
  restart_mode = 'restart',
  prefix = 'super',
  max_seconds = 600000.d0,
  nstep = 70000,
  dt = 50,
  forc_conv_thr = 1.0D-3,
  etot_conv_thr = 1.0D-4,
  tstress = .true.,
  tprnfor = .true.,
/
&SYSTEM
  ibrav       =  0,
  nat         = 216,
  ntyp        = 4,
  nosym       =.TRUE.,
  use_all_frac = .TRUE.,
  ecutwfc     = 64.d0,
  occupations = "smearing",
  smearing    = "gaussian",
  degauss     = 0.001D0,
/
&ELECTRONS
  conv_thr    = 1.D-7,
  electron_maxstep = 200,
/
&IONS
 ion_dynamics = 'verlet',
 ion_velocities = 'from_input'
 ion_temperature = 'not_controlled',
 pot_extrapolation = 'second-order',
 wfc_extrapolation = 'second-order',
/
ATOMIC_SPECIES
Li  6.941       Li.GGA-PBESOL-paw.UPF
B   10.811      B.GGA-PBESOL-paw.UPF
S   32.065      S.GGA-PBESOL-paw.UPF
Cl  35.453      Cl.GGA-PBESOL-paw.UPF
CELL_PARAMETERS {angstrom}
   1.5245113E+01   0.0000000E+00   0.0000000E+00
   0.0000000E+00   1.0485871E+01   0.0000000E+00
   3.1805976E-01   0.0000000E+00   2.1512337E+01


ATOMIC_POSITIONS {crystal}
Li       0.125905650  0.556156050  0.121053675
Li       0.125905650  0.556156050  0.621053675
Li       0.625905650  0.056156050  0.371053675
Li       0.625905650  0.056156050  0.871053675
Li       0.125905650  0.443843950  0.371053675
Li       0.125905650  0.443843950  0.871053675
Li       0.625905650  0.943843950  0.621053675
Li       0.625905650  0.943843950  0.121053675
Li       0.376996300  0.260087500  0.976542550
Li       0.376996300  0.260087500  0.476542550
Li       0.876996300  0.760087500  0.226542550
Li       0.876996300  0.760087500  0.726542550
Li       0.376996300  0.739912500  0.226542550
Li       0.376996300  0.739912500  0.726542550
Li       0.876996300  0.239912500  0.476542550
Li       0.876996300  0.239912500  0.976542550
Li       0.377826800  0.244658400  0.266433300
Li       0.377826800  0.244658400  0.766433300
Li       0.877826800  0.744658400  0.516433300
Li       0.877826800  0.744658400  0.016433300
Li       0.377826800  0.755341600  0.016433300
Li       0.377826800  0.755341600  0.516433300
Li       0.877826800  0.255341600  0.266433300
Li       0.877826800  0.255341600  0.766433300
Li       0.626360100  0.443950000  0.378051950
Li       0.626360100  0.443950000  0.878051950
Li       0.126360100  0.943950000  0.628051950
Li       0.126360100  0.943950000  0.128051950
Li       0.126360100  0.056050000  0.378051950
Li       0.126360100  0.056050000  0.878051950
Li       0.626360100  0.556050000  0.628051950
Li       0.626360100  0.556050000  0.128051950
Li       0.003728200  0.450119500  0.480702900
Li       0.003728200  0.450119500  0.980702900
Li       0.503728200  0.950119500  0.730702900
Li       0.503728200  0.950119500  0.230702900
Li       0.003728200  0.549880500  0.230702900
Li       0.003728200  0.549880500  0.730702900
Li       0.503728200  0.049880500  0.480702900
Li       0.503728200  0.049880500  0.980702900
Li       0.004132000  0.957603300  0.234372900
Li       0.004132000  0.957603300  0.734372900
Li       0.504132000  0.457603300  0.484372900
Li       0.504132000  0.457603300  0.984372900
Li       0.004132000  0.042396700  0.484372900
Li       0.004132000  0.042396700  0.984372900
Li       0.504132000  0.542396700  0.734372900
Li       0.504132000  0.542396700  0.234372900
B        0.251686100  0.499674400  0.000844250
B        0.251686100  0.499674400  0.500844250
B        0.751686100  0.999674400  0.250844250
B        0.751686100  0.999674400  0.750844250
B        0.751686100  0.000325600  0.000844250
B        0.751686100  0.000325600  0.500844250
B        0.251686100  0.500325600  0.250844250
B        0.251686100  0.500325600  0.750844250
B        0.252098650  0.000529150  0.249388475
B        0.252098650  0.000529150  0.749388475
B        0.752098650  0.500529150  0.499388475
B        0.752098650  0.500529150  0.999388475
B        0.252098650  0.999470850  0.999388475
B        0.252098650  0.999470850  0.499388475
B        0.752098650  0.499470850  0.249388475
B        0.752098650  0.499470850  0.749388475
B        0.001940550  0.249535050  0.125683225
B        0.001940550  0.249535050  0.625683225
B        0.501940550  0.749535050  0.375683225
B        0.501940550  0.749535050  0.875683225
B        0.001940550  0.750464950  0.375683225
B        0.001940550  0.750464950  0.875683225
B        0.501940550  0.250464950  0.625683225
B        0.501940550  0.250464950  0.125683225
B        0.174695500  0.246171400  0.050607350
B        0.174695500  0.246171400  0.550607350
B        0.674695500  0.746171400  0.300607350
B        0.674695500  0.746171400  0.800607350
B        0.174695500  0.753828600  0.300607350
B        0.174695500  0.753828600  0.800607350
B        0.674695500  0.253828600  0.550607350
B        0.674695500  0.253828600  0.050607350
B        0.329265900  0.405796800  0.126768100
B        0.329265900  0.405796800  0.626768100
B        0.829265900  0.905796800  0.376768100
B        0.829265900  0.905796800  0.876768100
B        0.829265900  0.094203200  0.626768100
B        0.829265900  0.094203200  0.126768100
B        0.329265900  0.594203200  0.876768100
B        0.329265900  0.594203200  0.376768100
B        0.329952800  0.094834400  0.122003100
B        0.329952800  0.094834400  0.622003100
B        0.829952800  0.594834400  0.372003100
B        0.829952800  0.594834400  0.872003100
B        0.329952800  0.905165600  0.872003100
B        0.329952800  0.905165600  0.372003100
B        0.829952800  0.405165600  0.122003100
B        0.829952800  0.405165600  0.622003100
B        0.171860350  0.253617050  0.201126175
B        0.171860350  0.253617050  0.701126175
B        0.671860350  0.753617050  0.451126175
B        0.671860350  0.753617050  0.951126175
B        0.171860350  0.746382950  0.951126175
B        0.171860350  0.746382950  0.451126175
B        0.671860350  0.246382950  0.201126175
B        0.671860350  0.246382950  0.701126175
S        0.147508800  0.417207200  0.031659850
S        0.147508800  0.417207200  0.531659850
S        0.647508800  0.917207200  0.281659850
S        0.647508800  0.917207200  0.781659850
S        0.147508800  0.582792800  0.281659850
S        0.147508800  0.582792800  0.781659850
S        0.647508800  0.082792800  0.531659850
S        0.647508800  0.082792800  0.031659850
S        0.357266750  0.450198950  0.043308675
S        0.357266750  0.450198950  0.543308675
S        0.857266750  0.950198950  0.293308675
S        0.857266750  0.950198950  0.793308675
S        0.857266750  0.049801050  0.043308675
S        0.857266750  0.049801050  0.543308675
S        0.357266750  0.549801050  0.293308675
S        0.357266750  0.549801050  0.793308675
S        0.356959100  0.052966900  0.205204100
S        0.356959100  0.052966900  0.705204100
S        0.856959100  0.552966900  0.455204100
S        0.856959100  0.552966900  0.955204100
S        0.356959100  0.947033100  0.955204100
S        0.356959100  0.947033100  0.455204100
S        0.856959100  0.447033100  0.205204100
S        0.856959100  0.447033100  0.705204100
S        0.146369150  0.081917450  0.221660775
S        0.146369150  0.081917450  0.721660775
S        0.646369150  0.581917450  0.471660775
S        0.646369150  0.581917450  0.971660775
S        0.646369150  0.418082550  0.221660775
S        0.646369150  0.418082550  0.721660775
S        0.146369150  0.918082550  0.471660775
S        0.146369150  0.918082550  0.971660775
S        0.074920650  0.148032450  0.072585225
S        0.074920650  0.148032450  0.572585225
S        0.574920650  0.648032450  0.322585225
S        0.574920650  0.648032450  0.822585225
S        0.074920650  0.851967550  0.322585225
S        0.074920650  0.851967550  0.822585225
S        0.574920650  0.351967550  0.572585225
S        0.574920650  0.351967550  0.072585225
S        0.430349650  0.365998850  0.173194375
S        0.430349650  0.365998850  0.673194375
S        0.930349650  0.865998850  0.423194375
S        0.930349650  0.865998850  0.923194375
S        0.430349650  0.634001150  0.923194375
S        0.430349650  0.634001150  0.423194375
S        0.930349650  0.134001150  0.173194375
S        0.930349650  0.134001150  0.673194375
S        0.432593650  0.138325350  0.076229325
S        0.432593650  0.138325350  0.576229325
S        0.932593650  0.638325350  0.326229325
S        0.932593650  0.638325350  0.826229325
S        0.432593650  0.861674650  0.826229325
S        0.432593650  0.861674650  0.326229325
S        0.932593650  0.361674650  0.076229325
S        0.932593650  0.361674650  0.576229325
S        0.070269650  0.349286150  0.182081025
S        0.070269650  0.349286150  0.682081025
S        0.570269650  0.849286150  0.432081025
S        0.570269650  0.849286150  0.932081025
S        0.070269650  0.650713850  0.432081025
S        0.070269650  0.650713850  0.932081025
S        0.570269650  0.150713850  0.682081025
S        0.570269650  0.150713850  0.182081025
S        0.233543250  0.174818750  0.981952325
S        0.233543250  0.174818750  0.481952325
S        0.733543250  0.674818750  0.231952325
S        0.733543250  0.674818750  0.731952325
S        0.733543250  0.325181250  0.481952325
S        0.733543250  0.325181250  0.981952325
S        0.233543250  0.825181250  0.731952325
S        0.233543250  0.825181250  0.231952325
S        0.770310800  0.043361900  0.915162400
S        0.770310800  0.043361900  0.415162400
S        0.270310800  0.543361900  0.165162400
S        0.270310800  0.543361900  0.665162400
S        0.270310800  0.456638100  0.915162400
S        0.270310800  0.456638100  0.415162400
S        0.770310800  0.956638100  0.165162400
S        0.770310800  0.956638100  0.665162400
S        0.272582600  0.956405800  0.084620550
S        0.272582600  0.956405800  0.584620550
S        0.772582600  0.456405800  0.334620550
S        0.772582600  0.456405800  0.834620550
S        0.272582600  0.043594200  0.334620550
S        0.272582600  0.043594200  0.834620550
S        0.772582600  0.543594200  0.584620550
S        0.772582600  0.543594200  0.084620550
S        0.230829700  0.324648400  0.268847900
S        0.230829700  0.324648400  0.768847900
S        0.730829700  0.824648400  0.518847900
S        0.730829700  0.824648400  0.018847900
S        0.230829700  0.675351600  0.018847900
S        0.230829700  0.675351600  0.518847900
S        0.730829700  0.175351600  0.268847900
S        0.730829700  0.175351600  0.768847900
S        0.251996950  0.250264150  0.125368925
S        0.251996950  0.250264150  0.625368925
S        0.751996950  0.750264150  0.375368925
S        0.751996950  0.750264150  0.875368925
S        0.251996950  0.749735850  0.875368925
S        0.251996950  0.749735850  0.375368925
S        0.751996950  0.249735850  0.125368925
S        0.751996950  0.249735850  0.625368925
Cl       0.009940300  0.244830400  0.411271650
Cl       0.009940300  0.244830400  0.911271650
Cl       0.509940300  0.744830400  0.661271650
Cl       0.509940300  0.744830400  0.161271650
Cl       0.009940300  0.755169600  0.161271650
Cl       0.009940300  0.755169600  0.661271650
Cl       0.509940300  0.255169600  0.411271650
Cl       0.509940300  0.255169600  0.911271650


ATOMIC_VELOCITIES
Li        -1.53161506329887E-03  -1.20674797378099E-03   2.36421342068632E-03
Li        -2.26857669456150E-03  -4.84700992732508E-04   6.18956622428387E-04
Li         1.56616280940193E-03   3.60668778805420E-04   1.37780487350976E-03
Li        -1.03652538669445E-03   4.43289920844433E-04  -1.37449274337872E-03
Li        -4.78664974105158E-04  -6.71861185467769E-04  -8.56545397342928E-04
Li        -1.79330045665056E-03   1.00873953313389E-03   9.96149863424359E-07
Li         1.08725062873251E-03  -1.77148239012941E-03  -3.88865793345172E-05
Li         7.05993608295869E-04  -2.52077127700743E-04   2.16191576369947E-03
Li         2.27984441388117E-04   1.20919921895013E-03  -6.01258752252386E-04
Li        -1.94638235235606E-03  -4.53865432763935E-03   2.42200552578403E-04
Li         2.46420785447119E-03   1.00483850134789E-03  -5.39212397121151E-04
Li        -1.98414779851490E-03   2.73177317567730E-03  -8.48029081477724E-04
Li        -7.68102218993896E-04  -1.57693777857450E-03   1.08792096609496E-03
Li        -9.36914844788937E-04   1.24971811582226E-03  -1.06388865728895E-03
Li        -3.23300204198170E-04   1.36634159154449E-03   1.49681034645673E-03
Li         1.76526376496409E-03  -4.25880881808735E-06   1.06492473009077E-03
Li        -3.07264603077078E-04   7.79406982851902E-04   1.06230328120816E-03
Li        -7.64887752128554E-04   3.23972142210124E-03  -1.16903645347499E-04
Li         2.26441353140347E-03   8.31596037283467E-04  -1.87657739072556E-03
Li         3.11384038336996E-03  -1.19754756914933E-03  -9.38923137650011E-04
Li        -1.75462525289704E-03  -3.49676854555575E-03  -1.28176802014703E-03
Li        -6.82980031277037E-04  -2.73312499717929E-03  -1.13262638514787E-04
Li         1.90664203843937E-03  -6.08624321413430E-05   2.48538071330880E-03
Li         8.93455063313318E-04  -6.80322882478289E-04  -1.19803880629060E-03
Li         1.42744354841463E-03   2.29068075567863E-05  -1.44496548973765E-03
Li         6.75380167398013E-04  -5.18892772802053E-04  -3.73040594992602E-03
Li         2.23388705220319E-03   5.20330839102494E-04   9.79868651296011E-05
Li         3.33152366769670E-03   7.52841626315031E-04  -2.29200175509598E-03
Li         9.25683213387581E-04  -4.95240948647274E-04   7.75758503386077E-04
Li         5.63924750131665E-04  -1.69531538006709E-04   1.65274017468095E-04
Li        -1.41803751608778E-03  -2.22370196338026E-03  -7.21687243142725E-05
Li         1.04691895848415E-03   2.40676122380481E-03  -1.31603019639853E-03
Li         1.58504592886641E-03   1.38197018389963E-03   9.87472116454987E-04
Li         2.49158342353016E-04   5.73584934640797E-04   7.79891131881790E-04
Li        -2.36969245442177E-03   1.48791305205664E-03   1.13067619674562E-04
Li        -1.57336970017468E-03   1.82901875907776E-03  -9.06809646146648E-04
Li        -7.02925525449260E-04   2.90779567234342E-03   1.12567367921711E-03
Li        -1.27384756784487E-03   1.28429321847073E-03  -8.49873145032313E-04
Li        -4.59128909074151E-04  -6.03620018970033E-04   8.66276497599609E-04
Li        -1.33488421404989E-03  -1.21924519959905E-03  -5.98142805202185E-04
Li        -4.39051109052876E-04   7.76248548058994E-04   1.51364301000139E-04
Li         7.36363522106488E-04  -3.04777816578372E-03  -9.30153331068579E-04
Li        -1.50993404493423E-03  -5.06418147721895E-03  -8.44453395099231E-05
Li         6.78789761148433E-04   2.78871980898162E-03  -1.16036240007660E-03
Li         3.75002120025312E-04  -8.23058665276628E-04   1.20954050179874E-03
Li        -1.36513603398453E-03   1.40959430985919E-03   2.18360458566504E-03
Li         6.16134711382303E-04  -1.25910007413534E-03  -9.62317962369694E-04
Li        -1.41717515876146E-03   1.73242557263704E-03   2.77612675254931E-03
B         -1.19228001961506E-03  -2.17788855170706E-03   1.21292860925769E-04
B          1.16918477545139E-03  -1.57318665093450E-04  -7.17581846869315E-04
B         -2.89338063873940E-05  -1.10857719968252E-03   3.33970956148934E-04
B         -2.51773311082795E-03   2.18605962736324E-04   9.27006078215094E-04
B          8.70761584931231E-04  -3.94668480143698E-04   2.94943195738747E-03
B         -1.01038166550142E-03  -1.17817117038714E-03   1.41433491141339E-03
B          1.83671624501743E-03   5.29189316608885E-04   6.56861144890132E-04
B          9.14706471182580E-04  -2.42813631068067E-03   6.57424926807626E-04
B         -8.25312397574306E-04   3.44852870077565E-04  -1.56477810495286E-03
B          1.12205645947112E-04   1.68137751962309E-03  -1.90352669213037E-03
B          6.83194053245414E-04  -4.23572985575393E-04   4.42988411506764E-04
B         -4.55638262802259E-04  -1.77735836797305E-03   1.96511831372607E-03
B          1.20567223493683E-05   9.15581507149099E-04  -7.64716180247603E-04
B          7.57741884867536E-04   1.80935473114718E-03   1.04238889911682E-03
B          9.85266272924787E-04   4.12874138312557E-04  -2.21307716851784E-03
B         -8.75317957210231E-05  -1.40505194367081E-03  -1.63695530477860E-03
B         -1.49901562773198E-03  -4.53777883338647E-03  -1.18201305709916E-03
B          7.65416845079424E-04   1.03550120549324E-03  -2.28373823819677E-03
B          3.70718637140293E-04  -1.19158539784286E-03   1.27748480296006E-03
B          1.77545713814370E-03   7.82933231332412E-04  -7.23657693939465E-04
B         -1.03137889307896E-05  -9.65265254254118E-05  -1.60490270751010E-03
B         -7.43818559506608E-04  -1.30130454845990E-03  -1.75728778540038E-03
B         -1.15837080277054E-03  -8.65324794923142E-04   8.76970832604256E-04
B         -7.59325174599034E-04  -5.93722515510207E-04  -1.59876905315327E-03
B         -1.38321096622414E-03  -1.01599317349441E-04   1.56786708067560E-03
B          8.79052960015169E-05  -6.12952239349284E-04   3.27228904617238E-04
B         -5.26729814484682E-04  -4.37304654913229E-04   7.06017931874009E-04
B          4.42380358145567E-04   9.19165114371315E-04   1.77140429643654E-04
B          3.16461991325371E-04  -9.06729984482453E-04   1.03861820948017E-03
B          1.93023963635613E-04   1.47459053441239E-03   1.86131930620489E-03
B          1.14445559640937E-03   2.53470664441906E-03  -1.90693856173762E-03
B          9.84855800132814E-04  -5.01862799246765E-04  -1.46825746421435E-04
B          6.04746672555294E-04   5.51505583182362E-04   2.92517376019054E-03
B          1.36024436799093E-03   6.39135667708815E-04  -9.98102178728191E-04
B          7.63396682930230E-04  -4.58813900840635E-04  -2.23241997907716E-04
B          1.58605263683555E-03   1.45744337053717E-03   3.08909765790662E-04
B         -5.48308026071812E-04   1.40561627555359E-03   2.00922013658303E-03
B         -3.48837675721962E-04  -2.25625386330400E-03  -2.62354285331888E-03
B         -5.40986959278941E-04   6.99472775534276E-04  -1.11591436795907E-03
B         -1.49680185019343E-03   5.62618343520596E-04  -1.34704108609401E-03
B         -1.50704979127163E-04  -1.70338585238554E-03   2.01805202169577E-04
B          1.41578338488372E-03   1.50724142501929E-03  -1.04714404716495E-03
B          2.58493171381222E-04   1.63455133959329E-03   1.37608927548700E-03
B          9.00639623539775E-04   1.28936855172421E-03  -9.01464708781066E-04
B         -1.52960070579979E-03   3.94060041284623E-05  -6.46704072551232E-04
B          3.85479050761385E-04  -1.07270550766087E-03  -3.78674232331512E-04
B          9.10795688374162E-05   1.42598190912869E-03  -8.60741937998404E-04
B          2.65287495632139E-03   2.68489234467238E-04   2.84357916950319E-04
B         -1.73368777045909E-03  -4.76696957285779E-04   9.12114874971558E-04
B          1.38481353556814E-04   4.55778922823820E-04  -6.85804454170503E-04
B          2.20420731229821E-04  -9.69286001166896E-04   8.66405985067169E-04
B         -1.94692078161334E-03   1.14944067764708E-03   1.48184958863578E-03
B          1.82707283246494E-04   1.31824063045103E-03   1.45481080217588E-03
B         -1.43808756047812E-03   9.18528119362877E-04  -3.97979017863126E-05
B         -3.21220309570931E-04   1.86900953975109E-03  -3.75607247639892E-04
B         -1.72915635500879E-03  -7.15983777370299E-04   1.08434596116707E-03
S          4.83724165043566E-04  -2.50610494327171E-04   1.36448430214333E-03
S         -8.30278035362841E-04  -6.23466576517079E-04  -1.04513082970791E-03
S          5.46989768155965E-04   9.46721857544732E-04  -1.48838004182236E-04
S         -2.63488591634829E-04   3.06521729681487E-04   1.09681935108539E-03
S         -3.22844826088443E-05   9.15835570435668E-04   5.58525227535944E-04
S          1.95095988102761E-04  -1.71660875952467E-04   7.57367638302514E-04
S          3.30246904559105E-04   8.78854025712420E-04   7.98306463211355E-05
S         -1.54787981024960E-04  -1.48369359012237E-03  -9.89274086934773E-04
S          1.13363904615831E-03  -5.57746361690419E-04  -2.89066990235744E-04
S          6.00175861512951E-04   1.33951569854620E-03   3.99766844790515E-04
S          5.67487669958464E-04  -1.52520417224331E-03   1.72974811126414E-04
S          6.65241612006823E-04  -3.18566260459690E-04   5.79600667675010E-04
S          3.78396149860468E-04   5.01483782370159E-04   4.54317611469370E-05
S          8.06428432007608E-04   2.77725078097061E-04  -7.02855837568461E-05
S         -6.39507786502270E-04   1.86316920612348E-04   9.33980656981228E-04
S         -1.11392629352768E-04   7.54903271884955E-05   3.72952685780221E-04
S         -5.79085544964269E-05   5.96876558160380E-04  -9.55237916804160E-04
S         -1.17368263059442E-03   2.89128174990659E-04   6.63304863029301E-04
S         -3.29249631553835E-04   2.22009222049169E-04   1.82968036748272E-04
S         -9.12377080011918E-05   1.01543048375356E-04  -1.38579463577754E-04
S          7.45558867118270E-05   1.11448534633700E-03  -2.52435470003202E-04
S         -1.62887472993823E-04  -2.28736846298750E-04   1.42956114467736E-03
S          3.55393526272079E-04  -2.65731993557211E-04   8.98048139536605E-05
S         -3.01775079761787E-05  -1.95111523727387E-04  -1.01796796125375E-03
S          4.95261265852279E-04  -5.41097672713856E-04  -7.25129796077446E-04
S          3.11510437961797E-04   4.72598192154714E-05  -1.42594752496824E-03
S         -2.25466132052611E-03  -2.53186247463223E-04   4.99601291730024E-04
S          5.81136548554610E-04   9.42887770127036E-05  -6.68287238419615E-04
S          9.94853494109075E-04   1.07014518798092E-03  -3.97238789719160E-04
S          1.33242151793608E-03  -2.12064215338202E-05  -1.14964643396372E-04
S         -1.96091058003323E-04  -5.19161482046283E-04  -1.73271155700222E-03
S         -7.29708940347506E-04  -1.00203342688400E-03   8.08548833363749E-04
S          2.21348906622217E-04   1.23013512373595E-03  -9.31974480455851E-04
S         -9.39476132544514E-05  -8.64422070897352E-04  -4.80747413045349E-04
S          9.85989274931062E-04   2.23169190069201E-04   6.45396315416552E-04
S         -4.46572605759714E-04  -1.35411479955675E-03   5.34698971050683E-04
S          2.90700780138171E-04  -3.09901487795065E-04   1.07401196044340E-03
S          4.05795124874382E-04  -4.73223680624223E-04  -2.83020702474367E-04
S         -2.46465306530958E-04  -2.79931478881730E-04  -5.33334308989438E-04
S         -7.37116206105635E-05   1.86993632227361E-04   2.81849285371969E-04
S          6.15429891492330E-04  -9.33327543391205E-04  -6.99373693750657E-04
S         -6.94005574947324E-04  -5.04080255641532E-04  -2.54312051531021E-04
S         -6.05289840807404E-04   6.63663764662588E-04  -3.05976487254236E-04
S          1.34572189801171E-03   9.24484825152709E-04  -1.70310981149363E-03
S          1.28063653653257E-03  -1.06999770149286E-03   5.58320582484089E-05
S         -5.47197546917172E-04  -4.59123260505219E-04   3.19382746074144E-05
S          7.97222247356800E-04  -1.25149808367469E-03   1.55789001368140E-03
S         -1.36405356721770E-03   1.81141069462175E-03   1.09258981689518E-03
S         -8.57807092598954E-04   5.29538583973337E-04   3.17762922609275E-05
S         -3.87447422484600E-04  -5.74929609667265E-04  -7.58026249846351E-04
S         -7.60466981969882E-04  -6.45978254523047E-04  -1.75591871213460E-04
S         -1.70862673528930E-05   1.54832279818963E-04  -9.69252423599614E-05
S          1.25601875622546E-03   2.36081114563736E-04   2.39100716926177E-04
S         -2.14235491593606E-04   2.29099087562629E-04   9.53887917358259E-05
S          3.63349046662315E-04  -4.96330317923702E-04   7.15557724746128E-04
S          1.81382831482915E-04  -9.62456360476730E-04  -4.42143969985569E-04
S         -8.03531229576112E-04  -1.77021922587462E-03  -4.00827700191977E-04
S         -4.84487084811057E-05  -1.05464100545000E-04  -1.58000935636359E-04
S          7.62411746754963E-04  -8.14085816502828E-04   9.37749958652484E-04
S         -3.04046474498703E-04   1.18883600401915E-03  -8.70376171601317E-04
S         -8.28277667071970E-05  -1.38724105773880E-04  -8.76245854809060E-04
S          3.81684382526999E-04  -6.98437328135743E-06   9.53206967234892E-04
S         -4.01021742791820E-04  -1.21316202451581E-03  -2.65768058619417E-04
S         -3.37255871639817E-04   6.80531661181592E-04  -2.88121158613937E-04
S          4.17523566612089E-04   7.67490923783628E-04   7.08225083726861E-05
S         -1.56073933005808E-04   7.44697441884544E-04   5.11694426978628E-04
S         -4.67941914382827E-04   8.48910071579089E-04  -6.39103950875880E-04
S         -8.22897827514263E-04  -2.10298008926440E-04  -1.56475454214495E-05
S          7.60048040419662E-05   4.11982881933475E-04   3.11683580299775E-04
S          1.05144878799456E-03   9.33172055567996E-04   6.02526000194447E-04
S         -3.43042101570036E-05  -4.16658528596406E-04   1.15288581121974E-03
S         -3.23287546916431E-04  -3.38513878423079E-04   2.15017626086040E-04
S          3.53947877619098E-04   3.38554267279312E-05  -1.19961519142722E-04
S         -1.16124609099562E-03   6.79477954830105E-04   5.27818325157839E-04
S         -4.95686128299162E-04   7.53231789566745E-05   2.34536869225275E-04
S         -6.00504076299092E-04   1.22319718025833E-04   2.35768361789324E-04
S          7.01016340277957E-04   1.15794718824790E-03  -3.23618500102203E-04
S         -7.42784607159878E-04  -7.35663637748661E-04   8.69717349708695E-04
S         -7.34766566147762E-05   1.70388772179402E-04   2.29913908428911E-04
S         -8.38677094680691E-04  -4.01970558161712E-04  -1.53650843420133E-06
S          4.31249837952136E-04  -7.47476945505573E-04  -8.76133227189558E-04
S         -7.15207516757721E-04  -1.65443837029833E-04   3.02354199636397E-04
S         -3.77187495783138E-04  -6.86712809362140E-04  -7.04261403364091E-04
S         -8.50700582883886E-04   1.34802575483697E-03  -6.06646858562317E-04
S          3.17960460410883E-04  -6.58871474887098E-04   5.06252945478033E-04
S          1.82976867579575E-04   3.19512099646873E-05   1.36796300117372E-03
S         -6.92060430888208E-04  -1.59782617500920E-03  -4.36744667527434E-04
S         -2.46464883391485E-04  -4.02857623316446E-04  -6.24262937469622E-04
S         -3.68442818294137E-04  -4.65613926262285E-04  -4.49329035017451E-05
S          1.16366679516337E-03   1.25513764354959E-03   5.34873714430293E-04
S         -1.38881928882716E-03  -3.33515753937408E-04  -5.84777713094775E-05
S          5.18846116212216E-04   1.63888735192705E-03   1.77748902159219E-05
S          1.61369840136200E-05   2.11461347763098E-04  -2.74352525198085E-04
S          1.14070522381150E-03  -6.76524439940388E-04  -9.90146805042619E-05
S         -6.97561967474708E-04   1.12562605290557E-04  -3.74925727569617E-05
S          1.56539235409924E-04   2.58232387794561E-04  -1.35951804915346E-03
S          4.54652543515045E-04   2.42335937441395E-03  -1.23160944712334E-03
S          1.82783584641252E-04  -7.70429990516534E-05  -3.96514957455099E-04
S          3.95796085832202E-04  -2.20886036666172E-04  -1.03272543532219E-03
S          1.44995025388368E-03   1.07848652132555E-03  -3.69363376195747E-04
S         -9.79505567355708E-04  -4.10301731800477E-05   2.95351135456556E-04
S          6.11944425619349E-04  -5.70355352688079E-05   6.50346630491530E-04
S          3.93828602370461E-04  -5.86280410506376E-04   7.69370803632026E-04
S         -1.38163439693554E-03  -3.21255647620125E-04   1.05770804288296E-03
Cl        -4.81130237089242E-04  -3.36046094584557E-04  -1.34937416603922E-03
Cl        -5.91107145504378E-04  -1.06646035434219E-04   5.37504608112739E-04
Cl        -4.56083638441634E-04  -4.65339949434336E-04   8.25897050837200E-04
Cl         4.43054129318183E-05   1.98390658120037E-03   9.70714857424507E-05
Cl         1.21733630097436E-03   1.67519539208024E-04   5.94919090403094E-04
Cl        -3.91089390577052E-04  -4.66154238221453E-04   1.93373128762194E-04
Cl         3.98334137617463E-04  -6.00553952569373E-04  -1.97467734582670E-04
Cl         2.59434560088661E-04  -1.76685850164457E-04  -7.01923463235785E-04


K_POINTS AUTOMATIC
1 1 1 1 1 1
EOF
```


## Option 1: xterm + GDB

Caveats:

* This method requires constant connectivity to keep the xterm windows open.
* X11 forwarding implies significant overhead

This option is the "traditional" method for parallel debugging using GDB, and is
elaborated on in [the official Open MPI
documentation](https://www.open-mpi.org/faq/?category=debugging).

```sh
mpirun --mca pml ob1 --mca btl vader,self xterm -e gdb --args $PW -in $INFILE
```


## Option 2: tmpi + tmux + GDB

Caveats:

* [tmpi](https://github.com/Azrael3000/tmpi) needs [reptyr](https://github.com/nelhage/reptyr) (source install)
* [tmpi](https://github.com/Azrael3000/tmpi) requires newer version of [tmux](https://github.com/tmux/tmux) (source install)
* [tmpi](https://github.com/Azrael3000/tmpi) needs custom mpi-options for interactive job
    * Modifying script is easy enough
    * Look into env variables:
```sh
export OMPI_MCA_pml=ob1
export OMPI_MCA_btl_base=self,vader
```

You should already be in a tmux session **before** starting your interactive
SLURM session. If this is not the case, start over and start tmux while on the
head node. While inside tmux, unset the `TMUX` environment variable in order to
enable nested tmux sessions,

```sh
unset TMUX
```

Now launch `tmpi` with the appropriate number of processes:

```sh
tmpi 8 gdb --args $PW -in $INFILE
```

This will launch a new nested tmux session with each process isolated to one
tmux pane. You can access the internal session with `ctrl+b ctrl+b`. Depending
on the number of processes, it may be quite cramped, so I recommend using the
`break-pane` command to separate the main output pane into a new tab. You should
then have tab `0:` with the initial command, `1:` with all of the helper
processes, and `2:` with the primary output. You can kill processes individually
or exit the session entirely with `ctrl+b ctrl+b &`.
